<div class="container mt-5">
    <h2>Pending Reservations</h2>
    <table class="table table-striped table-bordered">
        <thead>
            <tr>
                <th>ID</th>
                <th>User</th>
                <th>Space</th>
                <th>Vehicle</th>
                <th>Start Time</th>
                <th>End Time</th>
                <th>Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let reservation of pendingReservations">
                <td>{{ reservation.reservation_id }}</td>
                <td>{{ reservation.user_id }}</td>
                <td>{{ reservation.space_id }}</td>
                <td>{{ reservation.vehicle_id }}</td>
                <td>{{ reservation.reservation_start | date:'short' }}</td>
                <td>{{ reservation.reservation_end | date:'short' }}</td>
                <td>{{ reservation.status }}</td>
                <td>
                    <!-- BotÃ³n de editar convertido en icono -->
                    <i class="bi bi-pencil" (click)="openEditModal(reservation)" title="Edit"></i>
                    <!-- Nuevo icono para ver detalles -->
                    <i class="bi bi-eye" (click)="openViewModal(reservation)" title="View Details"></i>
                </td>
            </tr>
        </tbody>
    </table>

    <h2>Completed Reservations</h2>
    <table class="table table-striped table-bordered">
      <thead>
        <tr>
          <th>ID</th>
          <th>User</th>
          <th>Space</th>
          <th>Vehicle</th>
          <th>Start Time</th>
          <th>End Time</th>
          <th>Status</th>
          <th>Fee</th> <!-- Nueva columna para mostrar la tarifa -->
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let reservation of completedReservations">
          <td>{{ reservation.reservation_id }}</td>
          <td>{{ reservation.user_id }}</td>
          <td>{{ reservation.space_id }}</td>
          <td>{{ reservation.vehicle_id }}</td>
          <td>{{ reservation.reservation_start | date:'short' }}</td>
          <td>{{ reservation.reservation_end | date:'short' }}</td>
          <td>{{ reservation.status }}</td>
          <td>${{ reservation.fee || 0 }} </td> <!-- Mostrar la tarifa calculada -->
          <td>
            <i class="bi bi-pencil" (click)="openEditModal(reservation)" title="Edit"></i>
            <i class="bi bi-eye" (click)="openViewModal(reservation)" title="View Details"></i>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- Modal para ver detalles de la reserva -->
    <div class="modal fade" id="viewReservationModal" tabindex="-1" aria-labelledby="viewReservationModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="viewReservationModalLabel">Reservation Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p><strong>ID:</strong> {{ selectedReservation?.reservation_id }}</p>
                    <p><strong>User:</strong> {{ selectedReservation?.user_id }}</p>
                    <p><strong>Space:</strong> {{ selectedReservation?.space_id }}</p>
                    <p><strong>Vehicle:</strong> {{ selectedReservation?.vehicle_id }}</p>
                    <p><strong>Start Time:</strong> {{ selectedReservation?.reservation_start | date:'short' }}</p>
                    <p><strong>End Time:</strong> {{ selectedReservation?.reservation_end | date:'short' }}</p>
                    <p><strong>Status:</strong> {{ selectedReservation?.status }}</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal para editar reservas -->
<div class="modal fade" id="editReservationModal" tabindex="-1" aria-labelledby="editReservationModalLabel"
    aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editReservationModalLabel">Edit Reservation</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3">
                        <label for="user_id" class="form-label">User</label>
                        <input type="text" class="form-control" id="user_id" [value]="selectedReservation?.user_id"
                            readonly>
                    </div>
                    <div class="mb-3">
                        <label for="space_id" class="form-label">Space</label>
                        <input type="text" class="form-control" id="space_id" [value]="selectedReservation?.space_id"
                            readonly>
                    </div>
                    <div class="mb-3">
                        <label for="vehicle_id" class="form-label">Vehicle</label>
                        <input type="text" class="form-control" id="vehicle_id"
                            [value]="selectedReservation?.vehicle_id" readonly>
                    </div>
                    <div class="mb-3">
                        <label for="reservation_end" class="form-label">End Time</label>
                        <input type="datetime-local" class="form-control" id="reservation_end"
                            [(ngModel)]="selectedReservation.reservation_end" name="reservation_end" required>
                    </div>
                    <div class="mb-3">
                        <label for="status" class="form-label">Status</label>
                        <select class="form-select" [(ngModel)]="selectedReservation.status" name="status">
                            <option value="pending">Pending</option>
                            <option value="completed">Completed</option>
                            <option value="canceled">Canceled</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" (click)="updateReservation()">Save changes</button>
            </div>
        </div>
    </div>
</div>
